
// <cnx-pi data-type="cnx.eoc">class="summary" title="Chapter Review"</cnx-pi>
// <cnx-pi data-type="cnx.eoc">class="self-check-questions" title="Self-Check Questions"</cnx-pi>
// <cnx-pi data-type="cnx.eoc">class="review-questions" title="Review Questions"</cnx-pi>
// <cnx-pi data-type="cnx.eoc">class="critical-thinking" title="Critical Thinking Questions"</cnx-pi>
// <cnx-pi data-type="cnx.eoc">class="problems" title="Problems"</cnx-pi>
// <cnx-pi data-type="cnx.eoc">class="references" title="References"</cnx-pi>
//glossary

@import 'common/var-mixins';
@import 'common/numbering';
@import 'common/single-serving';
@import 'common/toc';

//numbering
// div[data-type='chapter'] {
//   .self-check-questions, .review-questions, .critical-thinking, .problems, .references {
//     //.x-numb ();
//   }
// }


//eoc
div[data-type='chapter'] {

  .glossary('Key Terms');
  .summary(summary, ~'.', h2, "Key Concepts and Summary");

  section.self-check-questions {
    .composite-origin (self-check-questions);
    div[data-type="solution"] {
      .solutions-origin (self-check-solutions);
    }
  }
  &::after {
    .composite-destination(self-check-questions);
  }

  section.review-questions {
    .composite-origin (review-questions);
  }
  &::after {
    .composite-destination(review-questions);
  }

  section.critical-thinking {
    .composite-origin (critical-thinking);
    div[data-type="solution"] {
      .solutions-origin (critical-thinking-solutions);
    }
  }
  &::after {
    .composite-destination(critical-thinking);
  }

  section.problems {
    .composite-origin (problems);
    div[data-type="solution"] {
      .solutions-origin (problems-solutions);
    }
  }
  &::after {
    .composite-destination(problems);
  }

  section.references:pass(35) {
    .composite-origin (references);
  }


// chapters

  //Answer Key
  &::after:pass(@pass-25-solutions) {
    container: h1;
    class: "chapter-area-title";
    content: "Chapter " nodes(nodeChapterNumber);
    move-to: chapterAreaTitle;
  }
  &::after:pass(@pass-25-solutions) {
    container: div;
    class: "self-check-solutions";
    content: pending(chapterAreaTitle) pending(self-check-solutions);
    move-to: chapterArea;
  }
  &::after:pass(@pass-25-solutions) {
    class: "chapter-area";
    content: pending(chapterArea);
    move-to: eob-all;
  }

  //References 
  &::after:pass(35) {
    container: h1;
    class: "chapter-area-text";
    content: nodes(nodeChapterText);
    move-to: chapterAreaText;
  }
  &::after:pass(35) {
    container: div;
    class: "references";
    content: pending(references);
    move-to: refArea;
  }
  &::after:pass(35) {
    class: "chapter-area";
    content: pending(chapterAreaText) pending(refArea);
    move-to: eob-references;
  }

  //feature titles
  .clearup {
    .doc-title("Clear It Up");
  }
  .linkup {
    .doc-title("Link It Up");
  }
  .bringhome {
    .doc-title("Bring It Home");
  }
  .workout {
    .doc-title("Work It Out");
  }
  .eoc {
    &.self-check-questions-container {
      .metadata("Self-Check Questions");
      .doc-title("Self-Check Questions");
    }
    &.review-questions-container {
      .metadata("Review Questions");
      .doc-title("Review Questions");
    }
    &.critical-thinking-container {
      .metadata("Critical Thinking Questions");
      .doc-title("Critical Thinking Questions");
    }
    &.problems-container {
      .metadata("Problems");
      .doc-title("Problems");
    }
    //TODO: Refactor metadata into summary, glossary mixins??
    &.glossary {
      .metadata("Key Terms");
    }
     &.summary {
      .metadata("Key Concepts and Summary");
    }
  }
}
body {
  //TODO: Be able to use .composite origin/destination for this
  &::after:pass(35) {
    class: "eob answer-key";
    data-type: "composite-page";
    content: pending(eob-all);
  }
  &::after:pass(36) {
    class: "eob references";
    data-type: "composite-page";
    content: pending(eob-references);
  }
  .eob {
    &.references {
      .metadata("References");
      //.doc-title("Answer Key");
      //TODO: Refactor, having to not use doc-title mixin in order to change the pass
      &::before:pass(37) {
        container: span;
        class: "text";
        content: "References";
        move-to: titleSpan;
      }
      &::before:pass(37) {
        container: h1;
        data-type: document-title;
        content: pending(titleSpan);
      }
    }
    &.answer-key {
      .metadata("Answer Key");
      //.doc-title("Answer Key");
      //TODO: Refactor, having to not use doc-title mixin in order to change the pass
      &::before:pass(36) {
        container: span;
        class: "text";
        content: "Answer Key";
        move-to: titleSpan;
      }
      &::before:pass(36) {
        container: h1;
        data-type: document-title;
        content: pending(titleSpan);
      }
    }
  }
}

